<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (ann.Ann__Network.Make)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">ann</a> &#x00BB; <a href="../index.html">Ann__Network</a> &#x00BB; Make</nav><h1>Module <code>Ann__Network.Make</code></h1></header><h3 class="heading">Parameters</h3><dl><code><a href="argument-1-L/index.html">L</a> : <a href="../../Ann/Layer/index.html#module-type-Sig">Ann.Layer.Sig</a></code></dl><h3 class="heading">Signature</h3><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>Type of a network</p></dd></dl><dl><dt class="spec type" id="type-data"><a href="#type-data" class="anchor"></a><code><span class="keyword">type </span>data</code><code><span class="keyword"> = </span><a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a><span class="keyword"> * </span><a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a></code></dt><dd><p>Type of data</p></dd></dl><dl><dt class="spec type" id="type-gradient_descent"><a href="#type-gradient_descent" class="anchor"></a><code><span class="keyword">type </span>gradient_descent</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-gradient_descent.Stochastic" class="anchored"><td class="def constructor"><a href="#type-gradient_descent.Stochastic" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Stochastic</span></code></td></tr><tr id="type-gradient_descent.Batch" class="anchored"><td class="def constructor"><a href="#type-gradient_descent.Batch" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Batch</span></code></td></tr><tr id="type-gradient_descent.MiniBatch" class="anchored"><td class="def constructor"><a href="#type-gradient_descent.MiniBatch" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">MiniBatch</span><span class="keyword"> of </span>int</code></td></tr></table></dt><dd><p>Type of gradient descent data training technique</p></dd></dl><dl><dt class="spec value" id="val-compose"><a href="#val-compose" class="anchor"></a><code><span class="keyword">val </span>compose : <a href="argument-1-L/index.html#type-t">L.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>compose l n</code> combines layer <code>l</code> and network <code>n</code></p></dd></dl><dl><dt class="spec value" id="val-(@.@)"><a href="#val-(@.@)" class="anchor"></a><code><span class="keyword">val </span>(@.@) : <a href="argument-1-L/index.html#type-t">L.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>l @.@ n</code> combines layer <code>l</code> and network <code>n</code></p></dd></dl><dl><dt class="spec value" id="val-of_layer"><a href="#val-of_layer" class="anchor"></a><code><span class="keyword">val </span>of_layer : <a href="argument-1-L/index.html#type-t">L.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_layer l</code> is the network with the single layer <code>l</code>.</p></dd></dl><dl><dt class="spec value" id="val-train"><a href="#val-train" class="anchor"></a><code><span class="keyword">val </span>train : ?&#8288;epsilon:float <span>&#45;&gt;</span> ?&#8288;learning:float <span>&#45;&gt;</span> ?&#8288;max_epoch:int option <span>&#45;&gt;</span> ?&#8288;gradient_type:<a href="index.html#type-gradient_descent">gradient_descent</a> <span>&#45;&gt;</span> ?&#8288;dropout:float <span>&#45;&gt;</span> ?&#8288;output_file:string option <span>&#45;&gt;</span> loss:(<a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a> <span>&#45;&gt;</span> <a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a> <span>&#45;&gt;</span> float) <span>&#45;&gt;</span> loss_deriv:(<a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a> <span>&#45;&gt;</span> <a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a> <span>&#45;&gt;</span> <a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>train ~ep lr me gt dp of lf ld n d</code> is a trained model of <code>t</code> using <code>ep</code> as the error threshold value for stopping training, the given data list, and the given loss function. <code>train</code> <code>forward_propogate</code>'s and <code>back_propogate</code>s <code>me</code> number of times or until the loss of the network drops below <code>ep</code>. Specifying <code>of</code> means that the network will be saved, <code>dp</code> is the dropout percentage necessary for forward propogation, with <code>lf</code> and <code>ld</code> being the loss function and its derivative, <code>n</code> being the network that is training, and <code>d</code> being the entire set of data that is being used for training. The parameter <code>gt</code> represents the type of gradient descent batching technique that is being used. Normalization techniques for batches are used.</p></dd></dl><dl><dt class="spec value" id="val-evaluate"><a href="#val-evaluate" class="anchor"></a><code><span class="keyword">val </span>evaluate : <a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Ann/Matrix/index.html#type-t">Ann.Matrix.t</a></code></dt><dd><p><code>evaluate m n</code> is the result of running <code>m</code> through the network <code>n</code>.</p></dd></dl><dl><dt class="spec value" id="val-eval_all"><a href="#val-eval_all" class="anchor"></a><code><span class="keyword">val </span>eval_all : ?&#8288;expand_output:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-data">data</a> <span>&#45;&gt;</span> float</code></dt><dd><p><code>eval_all eo n d</code> is the number of correct evaluations over the number of total test cases equalling the accuracy of the model itself. <code>eval_all</code> evaluates the network <code>n</code> using all supplied test data cases in <code>d</code>.</p></dd></dl><dl><dt class="spec value" id="val-format"><a href="#val-format" class="anchor"></a><code><span class="keyword">val </span>format : Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>format fmt t</code> prints out <code>t</code> to <code>fmt</code>.</p></dd></dl><dl><dt class="spec value" id="val-print"><a href="#val-print" class="anchor"></a><code><span class="keyword">val </span>print : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>print t</code> prints out <code>t</code> to <code>stdout</code>.</p></dd></dl><dl><dt class="spec value" id="val-save"><a href="#val-save" class="anchor"></a><code><span class="keyword">val </span>save : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>save t name</code> creates a directory where each csv file is the representation of a layer of t</p></dd></dl><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val </span>load : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>load dir</code> creates the network represented by the directory dir based on the layer conversion function f</p></dd></dl></div></body></html>